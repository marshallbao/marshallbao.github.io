# 域名解析

## Nameserver

域名服务器有三层，分别是

根域名服务器，负责告知域名属于哪个顶级域名服务器

.

顶级域名服务器，负责告知域名属于哪个权威 DNS 服务器

.top  ---> 

权威 DNS 服务器，负责具体域名的解析

sparkpay.top

当你修改你的某个域名的权威 DNS 服务器时，相当于告知顶级域名服务器，我的域名由新权威 DNS 服务器来负责了，下次有人来问的时候就会告知新权威 DNS 服务器的地址

## DNS

可以理解为递归解析器 + 缓存 DNS 记录

### DNS 解析流程

当你把电脑的 DNS 设置为 `8.8.8.8` 并访问 `sparkpay.top` 时，内部逻辑如下：

1. **发起请求**：你的电脑问 8.8.8.8：“`sparkpay.top` 的 IP 是多少？”
2. **咨询根部**：8.8.8.8 检查缓存，如果没有，它会去问 **根服务器 (.)**：“哪里能找到 `.top`？”
3. **获取方向**：根服务器说：“去问 `.top` 的 **TLD 服务器**，地址是 `a.zdnscloud.cn`。”
4. **继续追问**：8.8.8.8 跑去问 TLD 服务器：“`sparkpay.top` 在哪？”
5. **锁定目标**：TLD 服务器说：“这个域名归 **Name.com** 管，你去问 `ns1qsy.name.com`。”
6. **最终确认**：8.8.8.8 问 Name.com 的服务器：“IP 到底是多少？”
7. **拿到结果**：Name.com 给出 `91.195.240.94`。
8. **回报用户**：8.8.8.8 把这个结果存入自己的“脑子”（缓存）里，并告诉你的电脑。



#### 本地 DNS 和 公共 DNS 服务器是怎么协同工作的？

通过转发模式 (Most Common)进行，即先访问你本地的 DNS 服务器，如果没有就请求上游 DNS 服务器（在本地 DNS 中配置好了）

#### 域名解析A记录与CNAME有什么区别？

A 记录是直接将域名指向某个IP，如果您的主机IP不常变动就建议使用A记录。而别名解析是先将域名解析到主机别名再转跳到IP这样主机IP改变了不用重新解析。如果主机IP常变建议用别名解析

A记录正规些。独立IP能极大的提升用户网站被搜索引擎收录级别和机会，也就是一个IP只对应一个网站的话，搜索引擎会认为网站质量很高，提高收录级别，而共享IP条件下，一个IP下对应多个网站，搜索引擎会认为网站质量不高，而降低收录级别

多个域名解析到同一个IP会导致网站被收录降低！

A记录属正常解析到服务器IP地址，CNAME属于跳转解析。基本可以这样理解